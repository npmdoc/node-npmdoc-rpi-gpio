<html><head></head><body><div class="apidocDiv">
<style>
/*csslint
*/
.apidocDiv {
    background: #fff;
    font-family: Arial, Helvetica, sans-serif;
}
.apidocDiv a[href] {
    color: #33f;
    font-weight: bold;
    text-decoration: none;
}
.apidocDiv a[href]:hover {
    text-decoration: underline;
}
.apidocCodeCommentSpan {
    background: #bbf;
    color: #000;
    display: block;
}
.apidocCodeKeywordSpan {
    color: #d00;
    font-weight: bold;
}
.apidocCodePre {
    background: #eef;
    border: 1px solid;
    color: #777;
    padding: 5px;
    white-space: pre-wrap;
}
.apidocFooterDiv {
    margin-top: 20px;
    text-align: center;
}
.apidocModuleLi {
    margin-top: 10px;
}
.apidocSectionDiv {
    border-top: 1px solid;
    margin-top: 20px;
}
.apidocSignatureSpan {
    color: #777;
    font-weight: bold;
}
</style>
<h1>api documentation for
    <a href="https://github.com/JamesBarwell/rpi-gpio.js#readme">rpi-gpio (v0.8.1)</a>
</h1>
<h4>Control Raspberry Pi GPIO pins with node.js</h4>
<div class="apidocSectionDiv"><a href="#apidoc.tableOfContents" id="apidoc.tableOfContents"><h1>table of contents</h1></a><ol>

    <li class="apidocModuleLi"><a href="#apidoc.module.rpi-gpio">module rpi-gpio</a><ol>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rpi-gpio.destroy">
            function <span class="apidocSignatureSpan">rpi-gpio.</span>destroy
            <span class="apidocSignatureSpan">(cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rpi-gpio.input">
            function <span class="apidocSignatureSpan">rpi-gpio.</span>input
            <span class="apidocSignatureSpan">(channel, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rpi-gpio.output">
            function <span class="apidocSignatureSpan">rpi-gpio.</span>output
            <span class="apidocSignatureSpan">(channel, value, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rpi-gpio.read">
            function <span class="apidocSignatureSpan">rpi-gpio.</span>read
            <span class="apidocSignatureSpan">(channel, cb)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rpi-gpio.reset">
            function <span class="apidocSignatureSpan">rpi-gpio.</span>reset
            <span class="apidocSignatureSpan">()</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rpi-gpio.setMode">
            function <span class="apidocSignatureSpan">rpi-gpio.</span>setMode
            <span class="apidocSignatureSpan">(mode)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rpi-gpio.setup">
            function <span class="apidocSignatureSpan">rpi-gpio.</span>setup
            <span class="apidocSignatureSpan">(channel, direction, edge, onSetup)</span>
            </a>

        </li>

        <li>

            <a class="apidocElementLiA" href="#apidoc.element.rpi-gpio.write">
            function <span class="apidocSignatureSpan">rpi-gpio.</span>write
            <span class="apidocSignatureSpan">(channel, value, cb)</span>
            </a>

        </li>

        <li>

            <span class="apidocSignatureSpan">number <span class="apidocSignatureSpan">rpi-gpio.</span>_eventsCount</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">rpi-gpio.</span>_events</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">object <span class="apidocSignatureSpan">rpi-gpio.</span>domain</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>DIR_HIGH</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>DIR_IN</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>DIR_LOW</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>DIR_OUT</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>EDGE_BOTH</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>EDGE_FALLING</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>EDGE_NONE</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>EDGE_RISING</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>MODE_BCM</span>

        </li>

        <li>

            <span class="apidocSignatureSpan">string <span class="apidocSignatureSpan">rpi-gpio.</span>MODE_RPI</span>

        </li>

    </ol></li>

</ol></div>

<div class="apidocSectionDiv">
<h1><a href="#apidoc.module.rpi-gpio" id="apidoc.module.rpi-gpio">module rpi-gpio</a></h1>


    <h2>
        <a href="#apidoc.element.rpi-gpio.destroy" id="apidoc.element.rpi-gpio.destroy">
        function <span class="apidocSignatureSpan">rpi-gpio.</span>destroy
        <span class="apidocSignatureSpan">(cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">destroy = function (cb) {
    var tasks = Object.keys(exportedOutputPins)
        .concat(Object.keys(exportedInputPins))
        .map(function(pin) {
            return function(done) {
                removeListener(pin, pollers)
                unexportPin(pin, done);
            }
        });

    async.parallel(tasks, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
gpio.setup(16, gpio.DIR_OUT, pause);

function pause() {
    setTimeout(closePins, 2000);
}

function closePins() {
    gpio.<span class="apidocCodeKeywordSpan">destroy</span>(function() {
        console.log('All pins unexported');
    });
}
```


### Voltage cycling a pin
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rpi-gpio.input" id="apidoc.element.rpi-gpio.input">
        function <span class="apidocSignatureSpan">rpi-gpio.</span>input
        <span class="apidocSignatureSpan">(channel, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">input = function (channel, cb) {
    if (typeof cb !== 'function') {
        throw new Error('A callback must be provided')
    }

    var pin = getPinForCurrentMode(channel);

    if (!exportedInputPins[pin] &amp;&amp; !exportedOutputPins[pin]) {
        return process.nextTick(function() {
            cb(new Error('Pin has not been exported'));
        });
    }

    fs.readFile(PATH + '/gpio' + pin + '/value', 'utf-8', function(err, data) {
        if (err) {
            return cb(err)
        }
        data = (data + '').trim() || '0';
        debug('read pin %s with value %s', pin, data);
        return cb(null, data === '1');
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rpi-gpio.output" id="apidoc.element.rpi-gpio.output">
        function <span class="apidocSignatureSpan">rpi-gpio.</span>output
        <span class="apidocSignatureSpan">(channel, value, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">output = function (channel, value, cb) {
    var pin = getPinForCurrentMode(channel);
    cb = cb || function() {}

    if (!exportedOutputPins[pin]) {
        return process.nextTick(function() {
            cb(new Error('Pin has not been exported for write'));
        });
    }

    value = (!!value &amp;&amp; value !== '0') ? '1' : '0';

    debug('writing pin %d with value %s', pin, value);
    fs.writeFile(PATH + '/gpio' + pin + '/value', value, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">n/a</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rpi-gpio.read" id="apidoc.element.rpi-gpio.read">
        function <span class="apidocSignatureSpan">rpi-gpio.</span>read
        <span class="apidocSignatureSpan">(channel, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">read = function (channel, cb) {
    if (typeof cb !== 'function') {
        throw new Error('A callback must be provided')
    }

    var pin = getPinForCurrentMode(channel);

    if (!exportedInputPins[pin] &amp;&amp; !exportedOutputPins[pin]) {
        return process.nextTick(function() {
            cb(new Error('Pin has not been exported'));
        });
    }

    fs.readFile(PATH + '/gpio' + pin + '/value', 'utf-8', function(err, data) {
        if (err) {
            return cb(err)
        }
        data = (data + '').trim() || '0';
        debug('read pin %s with value %s', pin, data);
        return cb(null, data === '1');
    });
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
### Setup and read the value of a pin
```js
var gpio = require('rpi-gpio');

gpio.setup(7, gpio.DIR_IN, readInput);

function readInput() {
    gpio.<span class="apidocCodeKeywordSpan">read</span>(7, function(err, value) {
        console.log('The value is ' + value);
    });
}
```

### Setup and write to a pin
```js
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rpi-gpio.reset" id="apidoc.element.rpi-gpio.reset">
        function <span class="apidocSignatureSpan">rpi-gpio.</span>reset
        <span class="apidocSignatureSpan">()</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">reset = function () {
    exportedOutputPins = {};
    exportedInputPins = {};
    this.removeAllListeners();

    currentPins = undefined;
    getPinForCurrentMode = getPinRpi;
    pollers = {}
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    currentPins = undefined;
    getPinForCurrentMode = getPinRpi;
    pollers = {}
};

// Init
EventEmitter.call(this);
this.<span class="apidocCodeKeywordSpan">reset</span>();


// Private functions requring access to state
function setRaspberryVersion(cb) {
    if (currentPins) {
        return cb(null);
    }
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rpi-gpio.setMode" id="apidoc.element.rpi-gpio.setMode">
        function <span class="apidocSignatureSpan">rpi-gpio.</span>setMode
        <span class="apidocSignatureSpan">(mode)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setMode = function (mode) {
    if (mode === this.MODE_RPI) {
        getPinForCurrentMode = getPinRpi;
    } else if (mode === this.MODE_BCM) {
        getPinForCurrentMode = getPinBcm;
    } else {
        throw new Error('Cannot set invalid mode');
    }
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
    sandbox.stub(fs, 'exists').yieldsAsync(false);
    sandbox.stub(fs, 'openSync').returns('fakeFd')
    sandbox.stub(fs, 'readSync')
    sandbox.stub(fs, 'readFile')
        .withArgs('/proc/cpuinfo').yieldsAsync(null, getCpuInfo());

    gpio.reset();
    gpio.<span class="apidocCodeKeywordSpan">setMode</span>(gpio.MODE_BCM);
    gpio.version = 1;
});

afterEach(function() {
    sandbox.restore()
    listeners = []
});
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rpi-gpio.setup" id="apidoc.element.rpi-gpio.setup">
        function <span class="apidocSignatureSpan">rpi-gpio.</span>setup
        <span class="apidocSignatureSpan">(channel, direction, edge, onSetup)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">setup = function (channel, direction, edge, onSetup) {
    if (arguments.length === 2 &amp;&amp; typeof direction == 'function') {
        onSetup = direction;
        direction = this.DIR_OUT;
        edge = this.EDGE_NONE;
    } else if (arguments.length === 3 &amp;&amp; typeof edge == 'function') {
        onSetup = edge;
        edge = this.EDGE_NONE;
    }

    channel = parseInt(channel)
    direction = direction || this.DIR_OUT;
    edge = edge || this.EDGE_NONE;
    onSetup = onSetup || function() {};

    if (typeof channel !== 'number') {
        return process.nextTick(function() {
            onSetup(new Error('Channel must be a number'));
        });
    }

    if (direction !== this.DIR_IN &amp;&amp; direction !== this.DIR_OUT &amp;&amp; direction !== this.DIR_LOW &amp;&amp; direction !== this.DIR_HIGH) {
        return process.nextTick(function() {
            onSetup(new Error('Cannot set invalid direction'));
        });
    }

    if ([
        this.EDGE_NONE,
        this.EDGE_RISING,
        this.EDGE_FALLING,
        this.EDGE_BOTH
    ].indexOf(edge) == -1) {
        return process.nextTick(function() {
            onSetup(new Error('Cannot set invalid edge'));
        });
    }

    var pinForSetup;
    async.waterfall([
        setRaspberryVersion,
        function(next) {
            pinForSetup = getPinForCurrentMode(channel);
            if (!pinForSetup) {
                return next(new Error('Channel ' + channel + ' does not map to a GPIO pin'));
            }
            debug('set up pin %d', pinForSetup);
            isExported(pinForSetup, next);
        },
        function(isExported, next) {
            if (isExported) {
                return unexportPin(pinForSetup, next);
            }
            return next(null);
        },
        function(next) {
            exportPin(pinForSetup, next);
        },
        function(next) {
          async.retry({times: 100, interval: 10},
            function(cb){
              setEdge(pinForSetup, edge, cb);
            },
            function(err){
              // wrapped here because waterfall can't handle positive result
              next(err);
            });
        },
        function(next) {
            if (direction === this.DIR_IN) {
                exportedInputPins[pinForSetup] = true;
            } else {
                exportedOutputPins[pinForSetup] = true;
            }

            async.retry({times: 100, interval: 10},
              function(cb) {
                setDirection(pinForSetup, direction, cb);
              },
              function(err) {
                // wrapped here because waterfall can't handle positive result
                next(err);
              });
        }.bind(this),
        function(next) {
            listen(channel, function(readChannel) {
                this.read(readChannel, function(err, value) {
                    if (err) {
                        debug(
                            'Error reading channel value after change, %d',
                            readChannel
                        );
                        return
                    }
                    debug('emitting change on channel %s with value %s', readChannel, value);
                    this.emit('change', readChannel, value);
                }.bind(this));
            }.bind(this));
            next()
        }.bind(this)
    ], onSetup);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...

## Examples

### Setup and read the value of a pin
```js
var gpio = require('rpi-gpio');

gpio.<span class="apidocCodeKeywordSpan">setup</span>(7, gpio.DIR_IN, readInput);

function readInput() {
    gpio.read(7, function(err, value) {
        console.log('The value is ' + value);
    });
}
```
...</pre></li>
    </ul>



    <h2>
        <a href="#apidoc.element.rpi-gpio.write" id="apidoc.element.rpi-gpio.write">
        function <span class="apidocSignatureSpan">rpi-gpio.</span>write
        <span class="apidocSignatureSpan">(channel, value, cb)</span>
        </a>
    </h2>
    <ul>
    <li>description and source-code<pre class="apidocCodePre">write = function (channel, value, cb) {
    var pin = getPinForCurrentMode(channel);
    cb = cb || function() {}

    if (!exportedOutputPins[pin]) {
        return process.nextTick(function() {
            cb(new Error('Pin has not been exported for write'));
        });
    }

    value = (!!value &amp;&amp; value !== '0') ? '1' : '0';

    debug('writing pin %d with value %s', pin, value);
    fs.writeFile(PATH + '/gpio' + pin + '/value', value, cb);
}</pre></li>
    <li>example usage<pre class="apidocCodePre">...
### Setup and write to a pin
```js
var gpio = require('rpi-gpio');

gpio.setup(7, gpio.DIR_OUT, write);

function write() {
    gpio.<span class="apidocCodeKeywordSpan">write</span>(7, true, function(err) {
        if (err) throw err;
        console.log('Written to pin');
    });
}
```

### Setup and write to a pin that starts as on
...</pre></li>
    </ul>




























</div>

<div class="apidocFooterDiv">
    [ this document was created with
    <a href="https://github.com/kaizhu256/node-utility2" target="_blank">utility2</a>
    ]
</div>
</div>
</body></html>